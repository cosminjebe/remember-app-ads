<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Remember</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(180deg, #ffb225 0%, #fee48d 100%);
      
      color: #333;
      text-align: center;
      padding: 30px;
      min-height: 100vh;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: #ffffffa8;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .lang-select {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 8px;
    }
    .lang-select select {
      font-size: 14px;
      padding: 4px 8px;
    }
    .hero {
      margin: 16px 0 24px;
    }
    .hero-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      /*gap: 16px;*/
    }
    .avatar-grid {
      display: flex;
      gap: 0px;
      justify-content: center;
      align-items: stretch;
      flex-wrap: nowrap; /* keep avatars on one row */
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      width: 100%;
    }
    .avatar-card {
      flex: 0 0 33.3333%;
      max-width: 33.3333%;
      padding: 0px;
      background: rgba(194, 143, 2, 0);
      /*border-radius: 12px;*/
      display: flex;
      align-items: flex-end; /* stick content to bottom */
      justify-content: flex-end;
      cursor: pointer;
      overflow: hidden;
      min-height: 100px; /* keeps a minimum visual presence */
    }
    .avatar-card.is-active { background: rgb(255, 255, 255, 0); /*box-shadow: 0 2px 8px rgba(0,0,0,0.12); */}
    .avatar-anim { 
      width: 100%;
      height: auto; /* let height shrink so it can sit at the bottom */
      display: block;
      align-self: flex-end; /* ensure bottom alignment as a flex item */
      /* taie 10% din stânga și 10% din dreapta */
      clip-path: inset(0 0% 0 0%);
      position: relative; /* allow layering of idle/tap */
      min-height: 160px; /* fallback so absolute layers are visible pre-size */
    }
    .avatar-layer { position: absolute; inset: 0; }
    .avatar-layer[hidden] { display: none; }
    /* Remove mobile tap highlight on avatars */
    .avatar-card, .avatar-anim { -webkit-tap-highlight-color: transparent; }
    .avatar-card:focus-visible {
      outline: 3px solid #3366cc;
      outline-offset: 2px;
    }
    .message-box {
      background: linear-gradient(180deg, #fff6db 0%, #fff9e9 100%);
      /*border-radius: 12px;*/
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      padding: 12px 14px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 4.5em;
      max-height: 50px;
      width: 100%;
    }
    .hero-ctas {
      margin-top: 12px;
      display: flex;
      gap: 12px;
      justify-content: flex-start;
      flex-wrap: wrap;
    }
    .hero-ctas .btn {
      font-size: 16px;
      padding: 10px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }
    .hero-ctas .btn:focus-visible {
      outline: 3px solid #3366cc;
      outline-offset: 2px;
    }
    .btn-primary { background: #3366cc; color: #fff; }
    .btn-secondary { background: #eeeeee; color: #333; }
    @media (min-width: 768px) {
      .hero-inner { grid-template-columns: 1fr 1fr; align-items: center; }
    }
    /* Showcase section */
    :root { --shot-width: 220px; }
    .showcase { margin: 24px 0; background: linear-gradient(180deg, #fff6db 0%, #fff9e9 100%); padding: 40px 20px; border-radius: 12px; }
    .showcase-title { margin: 0 0 4px; font-size: 20px; font-weight: bold; color: #444; text-align: center; }
    .showcase-subtitle { margin: 0 0 16px; font-size: 15px; color: #555; text-align: center; }
    .showcase-inner { display: grid; gap: 16px; }
    .showcase-video { border-radius: 12px; overflow: hidden; }
    .showcase-video .video-wrapper { position: relative; width: var(--shot-width); margin: 0 auto; aspect-ratio: 9 / 16; background: #000; border-radius: 12px; overflow: hidden; }
    .showcase-video iframe { position: absolute; inset: 0; width: 100%; height: 100%; border: 0; }
    .screenshots { position: relative; }
    .shots-scroller { display: flex; gap: 12px; overflow-x: auto; -webkit-overflow-scrolling: touch; scroll-snap-type: x mandatory; padding-bottom: 6px; width: var(--shot-width); margin: 0 auto; }
    .shot { flex: 0 0 var(--shot-width); scroll-snap-align: center; }
    .shot-img { width: 100%; height: auto; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.12); transition: transform .2s ease, filter .2s ease; display: block; }
    .shot-img:hover { transform: translateY(-3px); filter: brightness(1.03); }
    .shot-cap { font-size: 13px; color: #555; margin: 6px 0 0; text-align: center; }
    /* Mobile: overlay arrows aligned and placed outside the image area */
    .shots-nav { position: absolute; top: 0; bottom: 0; left: 50%; transform: translateX(-50%); width: calc(var(--shot-width) + 80px); pointer-events: none; }
    .shots-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      background: rgba(255,255,255,0.9);
      color: #333;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      box-shadow: 0 2px 6px rgba(0,0,0,0.18);
      cursor: pointer;
      pointer-events: auto;
    }
    .shots-btn:focus-visible { outline: 3px solid #3366cc; outline-offset: 2px; }
    #shotsPrev { left: 0; }
    #shotsNext { right: 0; }
    @media (min-width: 992px) {
      /* Desktop: 3 fixed-width columns, no scroller */
      .showcase-inner { grid-template-columns: repeat(3, var(--shot-width)); justify-content: center; align-items: start; }
      .showcase-title, .showcase-subtitle { text-align: left; }
      .shots-nav { display: none; }
      .screenshots { display: contents; }
      .shots-scroller { display: contents; overflow: visible; padding-bottom: 0; width: auto; margin: 0; scroll-snap-type: none; }
      .shot { width: var(--shot-width); margin: 0; }
      .shot-img { width: var(--shot-width); height: calc(var(--shot-width) * (16 / 9)); object-fit: cover; }
      /* Make video as big as a screenshot card on desktop */
      .showcase-video { display: flex; justify-content: center; }
      .showcase-video .video-wrapper { width: var(--shot-width); }
    }
    /* Features section */
    .features {
      margin: 16px 0 24px;
      background: linear-gradient(180deg, #fff6db 0%, #fff9e9 100%);
      padding: 16px;
      border-radius: 12px;
    }
    .features-title {
      margin: 0 0 12px;
      font-size: 20px;
      font-weight: bold;
      color: #444;
    }
    /* Privacy strip */
    .privacy-strip { margin: 16px 0; background: #fff8e6; border-radius: 12px; padding: 16px; }
    .privacy-inner { max-width: 800px; margin: 0 auto; text-align: center; }
    .privacy-title { margin: 0 0 6px; font-size: 18px; color: #444; }
    .privacy-line { margin: 2px 0; font-size: 15px; color: #555; }
    .privacy-cta { display: inline-block; margin-top: 8px; color: #3366cc; text-decoration: underline; }
    .privacy-cta:focus-visible { outline: 3px solid #3366cc; outline-offset: 2px; }
    @media (min-width: 992px) { .privacy-inner { text-align: left; } }
    /* FAQ */
    .faq { margin: 16px 0 24px; }
    .faq-title { text-align: center; margin: 0 0 8px; font-size: 20px; color: #444; }
    .faq-list { max-width: 800px; margin: 0 auto; display: grid; gap: 8px; }
    .faq-item { background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); overflow: hidden; }
    .faq-q { list-style: none; padding: 12px 14px; cursor: pointer; font-size: 16px; }
    .faq-a-wrap { padding: 0 14px 12px; }
    .faq-a { margin: 0; font-size: 15px; color: #555; }
    .features-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    .feature-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      padding: 12px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      cursor: pointer;
    }
    .feature-card:focus-visible { outline: 3px solid #3366cc; outline-offset: 2px; }
    .feature-icon { width: 64px; height: 64px; margin: 4px auto 8px; }
    .feature-title { font-size: 18px; font-weight: bold; margin: 4px 0 6px; color: #444; }
    .feature-text { font-size: 15px; margin: 0; color: #555; }
    @media (min-width: 600px) {
      .features-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (min-width: 992px) {
      .features-grid { grid-template-columns: repeat(4, 1fr); }
      .feature-card:hover { transform: translateY(-3px); box-shadow: 0 6px 14px rgba(0,0,0,0.14); }
    }
    h1 {
      color: #444;
    }
    p {
      font-size: 18px;
      line-height: 1.6;
    }
    .app-icon {
      display: block;
      margin: 0 auto 16px;
      width: 120px;
      height: 120px;
      border-radius: 24px;
    }
    .caption {
      font-size: 18px;
      color: #666;
      margin: 8px 0 24px;
    }
    .buttons {
      display: flex;
      gap: 16px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }
    .store-badge {
      height: 48px;
      width: auto;
    }
    .socials {
      margin-top: 24px;
    }
    .socials-title {
      margin: 0 0 8px;
      font-size: 16px;
      color: #555;
    }
    .social-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }
    .social-badge {
      height: 40px;
      width: auto;
    }
    .footer {
      margin-top: 24px;
      font-size: 14px;
      color: #666;
      display: flex;
      gap: 16px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }
    .footer a { color: #3366cc; text-decoration: none; }
    .footer a:hover { text-decoration: underline; }
    @media (max-width: 600px) {
      .container {
        width: 90%;
        padding: 20px;
      }
    }
    /* Speech balloon overlay */
    .speech-balloon { position: absolute; z-index: 10; pointer-events: none; opacity: 0; visibility: hidden; transform: translateY(6px); transition: opacity .22s ease, transform .22s ease; max-height: 260px; }
    .speech-balloon.is-visible { opacity: 1; visibility: visible; transform: translateY(0); }
    .speech-balloon-img { display: block; width: 100%; height: 100%; }
    .speech-balloon-text { position: absolute; top: 7%; left: 7%; right: 7%; bottom: 15%; display: flex; align-items: center; justify-content: center; text-align: center; color: #333; font-size: 14px; line-height: 1.35; padding: 0 2px; opacity: 0; transition: opacity .22s ease; }
    .speech-balloon.is-visible.is-img-loaded .speech-balloon-text { opacity: 1; }
    /* Flip only the balloon image for penguin */
    .speech-balloon.is-flipped .speech-balloon-img { transform: scaleX(-1); }
  </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M424SWMFB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-7M424SWMFB');
  </script>
</head>
<body>
  <div class="container">
    <div class="lang-select">
      <select id="langSelect" aria-label="Language">
        <option value="en">EN</option>
        <option value="ro">RO</option>
        <option value="es">ES</option>
      </select>
    </div>
    <img src="images/appIcon.webp" alt="Remember App Icon" class="app-icon" width="120" height="120" />
    <h1 id="h1Title"></h1>
    <p class="caption" id="caption"></p>
    <div class="buttons">
      <a id="appleLink" href="https://apps.apple.com/ro/app/remember-memory-companion/id6747390663" aria-label="">
        <img src="images/downloadApple.webp" alt="Download on the App Store" class="store-badge" />
      </a>
      <a id="googleLink" href="https://play.google.com/store/apps/details?id=com.supercrg.remember" aria-label="">
        <img src="images/downloadGoogle.webp" alt="Get it on Google Play" class="store-badge" />
      </a>
    </div>
    <section class="hero" aria-label="Interactive hero">
      <div class="hero-inner">
          <div id="heroMsg" class="message-box" aria-live="polite"></div>
        <div class="avatar-grid">
          <div id="avatarFoxCard" class="avatar-card">
            <div id="avatarFoxAnim" class="avatar-anim" role="button" tabindex="0" aria-label=""></div>
          </div>
          <div id="avatarBearCard" class="avatar-card">
            <div id="avatarBearAnim" class="avatar-anim" role="button" tabindex="0" aria-label=""></div>
          </div>
          <div id="avatarPenguinCard" class="avatar-card">
            <div id="avatarPenguinAnim" class="avatar-anim" role="button" tabindex="0" aria-label=""></div>
          </div>
        </div>
        <div class="hero-ctas">
          <button id="heroCtaPrimary" class="btn btn-primary" aria-label=""></button>
          <button id="heroCtaSecondary" class="btn btn-secondary" aria-label=""></button>
        </div>
      </div>
    </section>
    <section class="features" aria-label="Value proposition">
      <h2 id="featuresTitle" class="features-title"></h2>
      <div class="features-grid">
        <div id="featureCard1" class="feature-card" role="button" tabindex="0" aria-label="Save memories privately">
          <img class="feature-icon" src="images/icons/icon_memory.png" alt="" onerror="this.outerHTML='\x3csvg class=feature-icon viewBox=\'0 0 48 48\' xmlns=\'http://www.w3.org/2000/svg\'\x3e\x3ccircle cx=\'24\' cy=\'24\' r=\'22\' fill=\'#ffe08a\'/\x3e\x3c/svg\x3e'">
          <div id="feature1Title" class="feature-title"></div>
          <p id="feature1Text" class="feature-text"></p>
        </div>
        <div id="featureCard2" class="feature-card" role="button" tabindex="0" aria-label="Feel-good self-care">
          <img class="feature-icon" src="images/icons/icon_selfcare.png" alt="" onerror="this.outerHTML='\x3csvg class=feature-icon viewBox=\'0 0 48 48\' xmlns=\'http://www.w3.org/2000/svg\'\x3e\x3crect x=\'6\' y=\'6\' width=\'36\' height=\'36\' rx=\'8\' fill=\'#ffd7a8\'/\x3e\x3c/svg\x3e'">
          <div id="feature2Title" class="feature-title"></div>
          <p id="feature2Text" class="feature-text"></p>
        </div>
        <div id="featureCard3" class="feature-card" role="button" tabindex="0" aria-label="Grow your avatar">
          <img class="feature-icon" src="images/icons/icon_growth.png" alt="" onerror="this.outerHTML='\x3csvg class=feature-icon viewBox=\'0 0 48 48\' xmlns=\'http://www.w3.org/2000/svg\'\x3e\x3cpolygon points=\'24,6 42,42 6,42\' fill=\'#ffc36b\'/\x3e\x3c/svg\x3e'">
          <div id="feature3Title" class="feature-title"></div>
          <p id="feature3Text" class="feature-text"></p>
        </div>
        <div id="featureCard4" class="feature-card" role="button" tabindex="0" aria-label="Make it yours">
          <img class="feature-icon" src="images/icons/icon_customize.png" alt="" onerror="this.outerHTML='\x3csvg class=feature-icon viewBox=\'0 0 48 48\' xmlns=\'http://www.w3.org/2000/svg\'\x3e\x3cpath d=\'M8 30h32v10H8zM14 8h20v16H14z\' fill=\'#ffb225\'/\x3e\x3c/svg\x3e'">
          <div id="feature4Title" class="feature-title"></div>
          <p id="feature4Text" class="feature-text"></p>
        </div>
      </div>
    </section>
   <!-- <div class="promo">
      <p id="promo1">A simple, private self-care app that helps you capture and cherish life’s meaningful moments.</p>
      <p id="promo2">Watch the video below to discover how Remember works and explore all its features.</p>
    </div>
    <!-- privacy + faq component include -->
    <div id="privacy-faq-root"></div>
    <script>
      (function(){
        try {
          fetch('components/privacy_faq.html')
            .then(function(r){ return r.text(); })
            .then(function(html){ var mount = document.getElementById('privacy-faq-root'); if (mount) mount.innerHTML = html; });
        } catch(e) {}
      })();
    </script>
    <!-- showcase component include -->
    <div id="showcase-root"></div>
    <script>
      (function(){
        try {
          fetch('components/showcase.html')
            .then(function(r){ return r.text(); })
            .then(function(html){
              var mount = document.getElementById('showcase-root');
              if (mount) mount.innerHTML = html;
              try { if (typeof window.__initShowcase === 'function') { window.__initShowcase(); } } catch(e) {}
            });
        } catch(e) {}
      })();
    </script>
    <div class="socials">
      <p class="socials-title" id="socialsTitle"></p>
      <div class="social-buttons">
        <a href="https://www.facebook.com/profile.php?id=61579630469393" aria-label="Facebook" rel="noopener">
          <img src="images/facebookButton.webp" alt="Facebook" class="social-badge" />
        </a>
        <a href="https://instagram.com/try.remember.app" aria-label="Instagram" rel="noopener">
          <img src="images/instaButton.webp" alt="Instagram" class="social-badge" />
        </a>
        <a href="https://www.tiktok.com/@rememberapp" aria-label="TikTok" rel="noopener">
          <img src="images/tiktokButton.webp" alt="TikTok" class="social-badge" />
        </a>
        <a href="https://www.youtube.com/@tryrememberapp" aria-label="YouTube" rel="noopener">
          <img src="images/youtubeButton.webp.png" alt="YouTube" class="social-badge" />
        </a>
      </div>
    </div>
    <div class="footer">
      <a id="footerSupport" href="mailto:remember.helpdesk@gmail.com"></a>
      <span>•</span>
      <a id="footerPrivacy" href="privacy.html"></a>
    </div>
  </div>

  <link rel="preload" href="JSONS/avatars/foxDefault.json" as="fetch" />
  <link rel="preload" href="JSONS/avatars/foxTap.json" as="fetch" />
  <link rel="preload" href="JSONS/avatars/bearDefault.json" as="fetch" />
  <link rel="preload" href="JSONS/avatars/bearTap.json" as="fetch" />
  <link rel="preload" href="JSONS/avatars/penguinDefault.json" as="fetch" />
  <link rel="preload" href="JSONS/avatars/penguinTap.json" as="fetch" />

  <!-- I18N -->
  <script>
    (function(){
      var translations = {};
      function getLang(){
        var stored = null;
        try { stored = localStorage.getItem('lang'); } catch(e) {}
        return (stored === 'en' || stored === 'ro' || stored === 'es') ? stored : 'en';
      }
      function loadLang(lang){
        return fetch('JSONS/i18n_' + lang + '.json').then(function(r){ return r.json(); });
      }
      // Expose translations globally for other scripts (hero interactions)
      try { window.__i18n = {}; } catch(e) {}

      function renderI18n(lang){
        var dict = translations[lang] || {};
        try { if (typeof dict['#documentTitle'] === 'string') { document.title = dict['#documentTitle']; } } catch(e) {}
        var el;
        function setText(idKey, elId){
          var text = dict[idKey];
          if (typeof text !== 'string') return;
          el = document.getElementById(elId);
          if (!el) return;
          // Do not overwrite heroMsg after it has been frozen by interaction
          if (elId === 'heroMsg' && el.getAttribute('data-frozen') === '1') return;
          
          el.textContent = text;
        }
        setText('#h1Title','h1Title');
        setText('#caption','caption');
        setText('#promo1','promo1');
        setText('#promo2','promo2');
        setText('#socialsTitle','socialsTitle');
        setText('#footerSupport','footerSupport');
        setText('#footerPrivacy','footerPrivacy');
        // Hero texts
        setText('#heroDefault','heroMsg');
        setText('#ctaPrimary','heroCtaPrimary');
        setText('#ctaSecondary','heroCtaSecondary');
        // Features texts
        setText('#featuresTitle','featuresTitle');
        setText('#feature1Title','feature1Title');
        setText('#feature1Text','feature1Text');
        setText('#feature2Title','feature2Title');
        setText('#feature2Text','feature2Text');
        setText('#feature3Title','feature3Title');
        setText('#feature3Text','feature3Text');
        setText('#feature4Title','feature4Title');
        setText('#feature4Text','feature4Text');
        // Showcase texts
        setText('#showcaseTitle','showcaseTitle');
        setText('#showcaseSubtitle','showcaseSubtitle');
        setText('#screenshot1Caption','screenshot1Caption');
        setText('#screenshot2Caption','screenshot2Caption');
        setText('#screenshot3Caption','screenshot3Caption');
        setText('#screenshot4Caption','screenshot4Caption');
        setText('#screenshot5Caption','screenshot5Caption');
        // Privacy strip + FAQ texts
        setText('#privacyStripTitle','privacyStripTitle');
        setText('#privacyStripLine1','privacyStripLine1');
        setText('#privacyStripLine2','privacyStripLine2');
        setText('#privacyStripCta','privacyStripCta');
        setText('#faqTitle','faqTitle');
        setText('#faqQ1','faqQ1'); setText('#faqA1','faqA1');
        setText('#faqQ2','faqQ2'); setText('#faqA2','faqA2');
        setText('#faqQ3','faqQ3'); setText('#faqA3','faqA3');
        setText('#faqQ4','faqQ4'); setText('#faqA4','faqA4');
        setText('#faqQ5','faqQ5'); setText('#faqA5','faqA5');
        // Hero aria-labels
        var foxAnim = document.getElementById('avatarFoxAnim');
        var bearAnim = document.getElementById('avatarBearAnim');
        var pengAnim = document.getElementById('avatarPenguinAnim');
        if (foxAnim && typeof dict['#avatarFoxAria'] === 'string') foxAnim.setAttribute('aria-label', dict['#avatarFoxAria']);
        if (bearAnim && typeof dict['#avatarBearAria'] === 'string') bearAnim.setAttribute('aria-label', dict['#avatarBearAria']);
        if (pengAnim && typeof dict['#avatarPenguinAria'] === 'string') pengAnim.setAttribute('aria-label', dict['#avatarPenguinAria']);
        var aApple = document.getElementById('appleLink');
        var aGoogle = document.getElementById('googleLink');
        if (aApple && typeof dict['#appleAria'] === 'string') aApple.setAttribute('aria-label', dict['#appleAria']);
        if (aGoogle && typeof dict['#googleAria'] === 'string') aGoogle.setAttribute('aria-label', dict['#googleAria']);
        var yt = document.getElementById('hero-video');
        if (yt && typeof dict['#ytTitle'] === 'string') yt.setAttribute('title', dict['#ytTitle']);
      }

      function applyLang(lang){
        document.documentElement.setAttribute('lang', lang);
        if (translations[lang]) { renderI18n(lang); return; }
        loadLang(lang).then(function(json){
          translations[lang] = json || {};
          try { window.__i18n = Object.assign({}, window.__i18n || {}, (function(o){ var obj={}; obj[lang]=json; return obj; })({})); } catch(e) {}
          renderI18n(lang);
        }).catch(function(){
          if (lang !== 'en') {
            loadLang('en').then(function(json){ translations['en'] = json || {}; renderI18n('en'); }).catch(function(){});
          }
        });
      }

      (function init(){
        var lang = getLang();
        applyLang(lang);
        var sel = document.getElementById('langSelect');
        if (sel) {
          sel.value = lang;
          sel.addEventListener('change', function(){
            var newLang = sel.value;
            try { localStorage.setItem('lang', newLang); } catch(e) {}
            applyLang(newLang);
            if (typeof gtag === 'function') {
              gtag('event', 'language_change', { language: newLang });
            }
          });
        }
      })();
    })();
  </script>

  <!-- Lottie -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>

  <!-- Hero logic -->
  <script>
    (function(){
      var reducedMotion = false;
      try { reducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches; } catch(e) {}
      var assets = {
        fox: { idle: 'JSONS/avatars/foxDefault.json', tap: 'JSONS/avatars/foxTap.json' },
        bear: { idle: 'JSONS/avatars/bearDefault.json', tap: 'JSONS/avatars/bearTap.json' },
        penguin: { idle: 'JSONS/avatars/penguinDefault.json', tap: 'JSONS/avatars/penguinTap.json' }
      };
      var players = {};
      var states = { fox: 'idle', bear: 'idle', penguin: 'idle' };
      var currentActive = null; // which avatar is currently in TAP loop
      // Speech balloon state
      var balloonEl = null; // root element
      var balloonTextEl = null;
      var balloonVisibleFor = null; // avatar name when visible
      var hasDismissedHeroMsg = false; // hide message-box after first tap
      var heroMsgInitialHeight = null; // remember initial message box height for restore
      var BALLOON_IMG_SRC = 'images/dialogueBaloon.webp';
      var BALLOON_FADE_MS = 220;
      var BALLOON_MAX_H = 260; // keep in sync with CSS max-height
      

      function ensureBalloon(){
        if (balloonEl) return balloonEl;
        var el = document.createElement('div');
        el.className = 'speech-balloon';
        // Start offscreen to avoid first-frame flash before positioning
        el.style.left = '-10000px';
        el.style.top = '-10000px';
        var img = new Image();
        img.src = BALLOON_IMG_SRC;
        img.alt = '';
        img.className = 'speech-balloon-img';
        var txt = document.createElement('div');
        txt.className = 'speech-balloon-text';
        el.appendChild(img);
        el.appendChild(txt);
        document.body.appendChild(el);
        balloonEl = el;
        balloonTextEl = txt;
        // Capture aspect ratio and reposition after image loads
        img.addEventListener('load', function(){
          try { el.__balloonAR = (img.naturalWidth && img.naturalHeight) ? (img.naturalWidth / img.naturalHeight) : 1.45; } catch(e) { el.__balloonAR = 1.45; }
          
          if (balloonEl) balloonEl.classList.add('is-img-loaded');
          if (balloonVisibleFor) { sizeBalloonForText(balloonVisibleFor); positionBalloonOver(balloonVisibleFor); }
        });
        return el;
      }
      function getBalloonAspectRatio(){
        ensureBalloon();
        return balloonEl && balloonEl.__balloonAR ? balloonEl.__balloonAR : 1.45;
      }
      function getAvatarMsg(name){
        var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
        var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
        var key = name === 'fox' ? '#foxMsg' : (name === 'bear' ? '#bearMsg' : '#penguinMsg');
        var text = dict[key];
        return (typeof text === 'string') ? text : '';
      }
      function hideHeroMsgWithFade(){
        if (hasDismissedHeroMsg) return;
        var msgEl = document.getElementById('heroMsg');
        if (!msgEl) { hasDismissedHeroMsg = true; return; }
        try {
          
          msgEl.style.transition = 'opacity .22s ease';
          msgEl.style.opacity = '0';
          // Freeze box to prevent any subsequent text assignments
          msgEl.setAttribute('data-frozen', '1');
          // Remove text immediately to avoid any flash
          msgEl.textContent = '';
          // Keep space reserved; do not collapse the box
          msgEl.setAttribute('aria-hidden', 'true');
        } catch(e) {}
        hasDismissedHeroMsg = true;
      }
      function showHeroDefaultWithFade(){
        try {
          var msgEl = document.getElementById('heroMsg');
          if (!msgEl) return;
          var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
          var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
          var text = (dict && typeof dict['#heroDefault'] === 'string') ? dict['#heroDefault'] : '';
          // Unfreeze and reveal the message box, then fade in
          try { msgEl.removeAttribute('data-frozen'); } catch(e) {}
          msgEl.setAttribute('aria-hidden', 'false');
          msgEl.style.visibility = 'visible';
          msgEl.textContent = text;
          // Restore initial height if captured
          if (heroMsgInitialHeight != null && heroMsgInitialHeight > 0) {
            msgEl.style.height = heroMsgInitialHeight + 'px';
          }
          msgEl.style.transition = 'opacity .22s ease';
          msgEl.style.opacity = '0';
          hasDismissedHeroMsg = false;
          try { recalcHeroMsgHeight(); } catch(e) {}
          try { requestAnimationFrame(function(){ requestAnimationFrame(function(){ msgEl.style.opacity = '1'; }); }); } catch(e) {}
        } catch(e) {}
      }
      function hideBalloonWithFade(){
        try {
          if (!balloonEl) { balloonVisibleFor = null; return; }
          balloonEl.classList.remove('is-visible');
          setTimeout(function(){ try { balloonEl.style.visibility = 'hidden'; } catch(e) {}; }, BALLOON_FADE_MS);
          balloonVisibleFor = null;
        } catch(e) {}
      }
      function positionBalloonOver(name){
        if (!balloonEl) return;
        try {
          var card = document.getElementById('avatar' + capitalize(name) + 'Card');
          if (!card) return;
          var r = card.getBoundingClientRect();
          var width = balloonEl.offsetWidth || 220;
          var estH = balloonEl.offsetHeight || Math.round(width / getBalloonAspectRatio());
          var left = Math.round(window.scrollX + r.left + (r.width - width) / 2);
          var top = Math.round(window.scrollY + r.top - estH + 8);
          // Keep within container horizontally
          var cont = document.querySelector('.container');
          if (cont) {
            var cr = cont.getBoundingClientRect();
            var minLeft = Math.round(window.scrollX + cr.left + 4);
            var maxLeft = Math.round(window.scrollX + cr.right - width - 4);
            if (left < minLeft) left = minLeft;
            if (left > maxLeft) left = maxLeft;
          }
          balloonEl.style.left = left + 'px';
          balloonEl.style.top = top + 'px';
        } catch(e) {}
      }
      function sizeBalloonForText(name){
        ensureBalloon();
        var card = document.getElementById('avatar' + capitalize(name) + 'Card');
        if (!balloonEl || !balloonTextEl || !card) return;
        var ar = getBalloonAspectRatio();
        var cardRect = card.getBoundingClientRect();
        var baseW = Math.max(180, cardRect.width * 1.1);
        var cont = document.querySelector('.container');
        var contW = cont ? cont.getBoundingClientRect().width : (window.innerWidth - 20);
        var maxWFromCap = BALLOON_MAX_H * ar;
        var maxWViewport = Math.max(200, Math.min(contW - 8, window.innerWidth - 20));
        var maxW = Math.max(200, Math.min(maxWFromCap, maxWViewport));
        var width = Math.min(Math.max(Math.round(baseW), 180), Math.round(maxW));
        // Apply and check text fit, expand until it fits or reaches maxW
        function applyWidth(w){ balloonEl.style.width = Math.round(w) + 'px'; }
        applyWidth(width);
        // Force a layout before measuring
        void balloonEl.offsetWidth;
        var tries = 0;
        while (tries < 8) {
          var fits = balloonTextEl.scrollHeight <= balloonTextEl.clientHeight;
          if (fits || width >= maxW - 1) break;
          width = Math.min(Math.round(width * 1.14), Math.round(maxW));
          applyWidth(width);
          void balloonEl.offsetWidth;
          tries++;
        }
      }
      function showBalloonFor(name){
        ensureBalloon();
        var text = getAvatarMsg(name);
        if (balloonTextEl) balloonTextEl.textContent = text;
        // Size and position BEFORE toggling visibility to avoid flicker
        
        sizeBalloonForText(name);
        positionBalloonOver(name);
        
        try {
          if (balloonEl) {
            if (name === 'penguin') balloonEl.classList.add('is-flipped');
            else balloonEl.classList.remove('is-flipped');
          }
        } catch(e) {}
        // Ensure the element starts fully hidden to avoid any intermediate paint
        if (balloonEl) { balloonEl.classList.remove('is-visible'); balloonEl.style.visibility = 'hidden'; }
        // Debug: log when the text actually becomes visible (end of opacity transition)
        try {
          if (balloonTextEl) {
            var onceFn = function(ev){
              if (ev && ev.propertyName === 'opacity' && balloonEl && balloonEl.classList && balloonEl.classList.contains('is-visible')) { }
            };
            balloonTextEl.addEventListener('transitionend', onceFn, { once: true });
          }
        } catch(e) {}
        if (reducedMotion) {
          
          if (balloonEl) balloonEl.style.visibility = 'visible';
          balloonEl.classList.add('is-visible');
          
        } else {
          // If previously visible for another avatar, ensure restart of transition
          balloonEl.classList.remove('is-visible');
          // Force reflow to restart CSS transition
          void balloonEl.offsetWidth; // eslint-disable-line no-unused-expressions
          
          if (balloonEl) balloonEl.style.visibility = 'visible';
          balloonEl.classList.add('is-visible');
          // Also verify via RAF after style application
          try {
            requestAnimationFrame(function(){
              requestAnimationFrame(function(){
                if (!balloonTextEl) return;
                var op = '';
                try { op = window.getComputedStyle(balloonTextEl).opacity; } catch(e) {}
                if (op === '1') { }
              });
            });
          } catch(e) {}
        }
        balloonVisibleFor = name;
      }
      function switchBalloonTo(name){
        ensureBalloon();
        if (!balloonVisibleFor) { showBalloonFor(name); return; }
        if (balloonVisibleFor === name) { showBalloonFor(name); return; }
        if (reducedMotion) {
          showBalloonFor(name);
          return;
        }
        // Fade out, then update, then fade in
        
        balloonEl.classList.remove('is-visible');
        setTimeout(function(){
          // Pre-size and position while hidden to avoid flicker
          if (balloonTextEl) balloonTextEl.textContent = getAvatarMsg(name);
          sizeBalloonForText(name);
          positionBalloonOver(name);
          try { if (balloonEl) { if (name === 'penguin') balloonEl.classList.add('is-flipped'); else balloonEl.classList.remove('is-flipped'); } } catch(e) {}
          // Then show
          showBalloonFor(name);
        }, BALLOON_FADE_MS);
      }
      function ensureLayers(name){
        var parent = document.getElementById('avatar' + capitalize(name) + 'Anim');
        if (!parent) return null;
        var idle = parent.querySelector('.avatar-layer.idle');
        if (!idle) {
          idle = document.createElement('div');
          idle.className = 'avatar-layer idle';
          idle.setAttribute('data-layer', 'idle');
          idle.setAttribute('hidden', '');
          parent.appendChild(idle);
        }
        var tap = parent.querySelector('.avatar-layer.tap');
        if (!tap) {
          tap = document.createElement('div');
          tap.className = 'avatar-layer tap';
          tap.setAttribute('data-layer', 'tap');
          tap.setAttribute('hidden', '');
          parent.appendChild(tap);
        }
        return { parent: parent, idle: idle, tap: tap };
      }
      function initAvatar(name){
        if (!window.lottie) return;
        var layers = ensureLayers(name);
        if (!layers) return;
        // If already initialized, just ensure we show current state
        if (players[name] && players[name].idle && players[name].tap) {
          showLayer(name, states[name] || 'idle');
          return;
        }
        // Destroy any stray instances
        try {
          if (players[name] && players[name].idle) players[name].idle.destroy();
          if (players[name] && players[name].tap) players[name].tap.destroy();
        } catch(e) {}
        var idleAnim = lottie.loadAnimation({
          container: layers.idle,
          renderer: 'svg',
          loop: !reducedMotion,
          autoplay: false,
          path: assets[name].idle,
          rendererSettings: { progressiveLoad: true }
        });
        var tapAnim = lottie.loadAnimation({
          container: layers.tap,
          renderer: 'svg',
          loop: !reducedMotion,
          autoplay: false,
          path: assets[name].tap,
          rendererSettings: { progressiveLoad: true }
        });
        players[name] = { idle: idleAnim, tap: tapAnim };
        // Pre-render first frame of tap offscreen to avoid first-show blank
        try { tapAnim.goToAndStop(0, true); } catch(e) {}
        // Size updates when layers load
        try { idleAnim.addEventListener('DOMLoaded', function(){ updateCardSizeByName(name); }); } catch(e) {}
        try { tapAnim.addEventListener('DOMLoaded', function(){ updateCardSizeByName(name); }); } catch(e) {}
        // Reduced motion: when tap completes, return to idle
        if (reducedMotion) {
          try { tapAnim.addEventListener('complete', function(){ showLayer(name, 'idle'); }); } catch(e) {}
        }
        // Start with idle visible
        states[name] = 'idle';
        showLayer(name, 'idle');
        setTimeout(function(){ updateCardSizeByName(name); }, 50);
      }
      function showLayer(name, layer){
        var layers = ensureLayers(name);
        if (!layers || !players[name]) return;
        var idleAnim = players[name].idle;
        var tapAnim = players[name].tap;
        if (layer === 'tap') {
          layers.idle.setAttribute('hidden', '');
          layers.tap.removeAttribute('hidden');
          try { idleAnim.pause(); } catch(e) {}
          try { tapAnim.goToAndPlay(0, true); } catch(e) {}
          states[name] = 'tap';
          try {
            var cardTap = document.getElementById('avatar' + capitalize(name) + 'Card');
            if (cardTap) cardTap.classList.add('is-active');
          } catch(e) {}
        } else {
          layers.tap.setAttribute('hidden', '');
          layers.idle.removeAttribute('hidden');
          try { tapAnim.pause(); } catch(e) {}
          try {
            if (!reducedMotion) { idleAnim.play(); }
            else { idleAnim.goToAndStop(0, true); }
          } catch(e) {}
          states[name] = 'idle';
          try {
            var cardIdle = document.getElementById('avatar' + capitalize(name) + 'Card');
            if (cardIdle) cardIdle.classList.remove('is-active');
          } catch(e) {}
        }
        updateCardSizeByName(name);
      }
      function playTap(name){
        var container = document.getElementById('avatar' + capitalize(name) + 'Anim');
        if (!container || !window.lottie) return;
        // If tapping the same active avatar, reset hero state
        if (currentActive === name && states[name] === 'tap'){
          showLayer(name, 'idle');
          currentActive = null;
          hideBalloonWithFade();
          showHeroDefaultWithFade();
          return;
        }
        
        initAvatar(name);
        // If tapped avatar is already active, do nothing
        if (states[name] === 'tap') return;
        // Revert previously active to idle
        if (currentActive && currentActive !== name) {
          try {
            var prevCard = document.getElementById('avatar' + capitalize(currentActive) + 'Card');
            if (prevCard) prevCard.classList.remove('is-active');
          } catch(e) {}
          showLayer(currentActive, 'idle');
        }
        showLayer(name, 'tap');
        currentActive = name;
        try { attachSizeObservers(name); } catch(e) {}
        setTimeout(function(){ updateCardSizeByName(name); attachSizeObservers(name); }, 50);
        // Hide hero message and show/update speech balloon (synchronously clear text first to avoid flash)
        try { var hm = document.getElementById('heroMsg'); if (hm) { hm.textContent = ''; hm.setAttribute('data-frozen','1'); hm.setAttribute('aria-hidden','true'); hm.style.opacity = '0'; hm.style.visibility = 'hidden'; } } catch(e) {}
        hideHeroMsgWithFade();
        if (!balloonVisibleFor) { showBalloonFor(name); } else { switchBalloonTo(name); }
        if (typeof gtag === 'function') {
          gtag('event', 'avatar_tap', { character: name, transport_type: 'beacon' });
        }
      }
      function addCardHandlers(name){
        var animEl = document.getElementById('avatar' + capitalize(name) + 'Anim');
        if (!animEl) return;
        animEl.addEventListener('click', function(){ playTap(name); });
        animEl.addEventListener('keydown', function(ev){
          if (ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); playTap(name); }
        });
      }
      function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }
      function updateCardSizeByName(name){
        try {
          var container = document.getElementById('avatar' + capitalize(name) + 'Anim');
          var card = document.getElementById('avatar' + capitalize(name) + 'Card');
          if (!container || !card) return;
          var target = container.querySelector('.avatar-layer:not([hidden]) svg') || container.querySelector('svg') || container;
          var rect = target.getBoundingClientRect();
          if (rect && rect.width && rect.height) {
            card.style.width = Math.ceil(rect.width) + 'px';
            card.style.height = Math.ceil(rect.height) + 'px';
            container.style.width = Math.ceil(rect.width) + 'px';
            container.style.height = Math.ceil(rect.height) + 'px';
          }
        } catch(e) {}
      }
      function attachSizeObservers(name){
        try {
          if (!('ResizeObserver' in window)) return;
          window.__avatarResizeObservers = window.__avatarResizeObservers || {};
          var key = name;
          if (window.__avatarResizeObservers[key]) { try { window.__avatarResizeObservers[key].disconnect(); } catch(e) {} }
          var container = document.getElementById('avatar' + capitalize(name) + 'Anim');
          if (!container) return;
          var ro = new ResizeObserver(function(){ updateCardSizeByName(name); });
          ro.observe(container);
          var svgs = container.querySelectorAll('svg');
          svgs.forEach(function(s){ ro.observe(s); });
          // Watch for svg insertions by lottie across both layers
          var mo = new MutationObserver(function(){
            try {
              var sv = container.querySelectorAll('svg');
              sv.forEach(function(s){ ro.observe(s); });
            } catch(e) {}
            updateCardSizeByName(name);
          });
          mo.observe(container, { childList: true, subtree: true });
          ro.__mo = mo;
          window.__avatarResizeObservers[key] = ro;
        } catch(e) {}
      }
      function updateAllCardSizes(){ ['fox','bear','penguin'].forEach(updateCardSizeByName); }
      function initHeroMsg(){
        var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
        var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
        var msgEl = document.getElementById('heroMsg');
        if (msgEl && msgEl.getAttribute('data-frozen') !== '1' && dict && typeof dict['#heroDefault'] === 'string') {
          
          msgEl.textContent = dict['#heroDefault'];
          // Capture initial height once for later restore
          try {
            if (heroMsgInitialHeight == null) {
              // After text set, allow layout settle then read height
              setTimeout(function(){
                try {
                  var h = msgEl.getBoundingClientRect().height;
                  if (h && h > 0) heroMsgInitialHeight = Math.round(h);
                } catch(e) {}
              }, 0);
            }
          } catch(e) {}
        }
      }
      function recalcHeroMsgHeight(){
        try {
          if (hasDismissedHeroMsg) return; // do not measure or mutate after first tap
          var msgEl = document.getElementById('heroMsg');
          if (!msgEl) return;
          var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
          var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
          var candidates = ['#heroDefault', '#foxMsg', '#bearMsg', '#penguinMsg']
            .map(function(k){ return typeof dict[k] === 'string' ? dict[k] : ''; });
          var measurer = document.createElement('div');
          measurer.className = 'message-box';
          measurer.style.position = 'absolute';
          measurer.style.visibility = 'hidden';
          measurer.style.left = '-9999px';
          measurer.style.top = '0';
          measurer.style.height = 'auto';
          measurer.style.minHeight = '0';
          measurer.style.maxHeight = 'none';
          // match current width for accurate wrapping
          var width = msgEl.clientWidth || msgEl.getBoundingClientRect().width;
          if (width) measurer.style.width = width + 'px';
          document.body.appendChild(measurer);
          var maxH = 0;
          for (var i = 0; i < candidates.length; i++) {
            measurer.textContent = candidates[i];
            // force reflow
            var h = measurer.scrollHeight;
            if (h > maxH) maxH = h;
          }
          measurer.remove();
          if (heroMsgInitialHeight != null && heroMsgInitialHeight > 0) {
            // Lock to initial measured height to avoid growth on mobile after restore
            msgEl.style.height = heroMsgInitialHeight + 'px';
          } else if (maxH > 0) {
            msgEl.style.height = maxH + 'px';
          }
        } catch(e) {}
      }
      function initCtas(){
        var primary = document.getElementById('heroCtaPrimary');
        var secondary = document.getElementById('heroCtaSecondary');
        if (primary) {
          primary.addEventListener('click', function(){
            var ua = (navigator.userAgent || '').toLowerCase();
            var appleHref = (document.getElementById('appleLink') || {}).href;
            var googleHref = (document.getElementById('googleLink') || {}).href;
            var target = /android/i.test(ua) ? googleHref : appleHref || googleHref;
            if (typeof gtag === 'function') { gtag('event', 'cta_click', { location: 'hero', type: 'primary' }); }
            if (target) { window.location.href = target; }
          });
        }
        if (secondary) {
          secondary.addEventListener('click', function(){
            if (typeof gtag === 'function') { gtag('event', 'cta_click', { location: 'hero', type: 'secondary' }); }
            var v = document.getElementById('hero-video');
            if (v && typeof v.scrollIntoView === 'function') { v.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
          });
        }
      }
      // Expose translations for hero access
      try { window.__i18n = (window.__i18n || {}); var t = (function(){ return (function(){ var s=document.currentScript; while(s && s.tagName!== 'SCRIPT') s=s.previousSibling; return s; })(); })(); } catch(e) {}
      // Copy translations object reference for hero use
      try { window.__i18n = Object.assign({}, window.__i18n, (function(){ var scr = document.querySelector('script:nth-of-type(2)'); return window.__i18n; })()); } catch(e) {}
      // During i18n init, we already set hero default text; ensure again here
      initHeroMsg();
      recalcHeroMsgHeight();
      // Init avatars with dual layers (idle + tap preloaded)
      initAvatar('fox');
      initAvatar('bear');
      initAvatar('penguin');
      addCardHandlers('fox');
      addCardHandlers('bear');
      addCardHandlers('penguin');
      // CTAs
      initCtas();
      // Initial size adjustment and observers
      setTimeout(function(){ updateAllCardSizes(); attachSizeObservers('fox'); attachSizeObservers('bear'); attachSizeObservers('penguin'); }, 120);
      try { window.addEventListener('resize', updateAllCardSizes); } catch(e) {}
      try {
        window.addEventListener('resize', function(){
          recalcHeroMsgHeight();
          if (balloonVisibleFor) { sizeBalloonForText(balloonVisibleFor); positionBalloonOver(balloonVisibleFor); }
        });
        window.addEventListener('scroll', function(){ if (balloonVisibleFor) { sizeBalloonForText(balloonVisibleFor); positionBalloonOver(balloonVisibleFor); } }, { passive: true });
      } catch(e) {}
      // React to language changes by resetting default message via MutationObserver on <html lang>
      try {
        var mo = new MutationObserver(function(m){ initHeroMsg(); recalcHeroMsgHeight(); updateCtaLabels(); updateAvatarAria(); if (balloonVisibleFor) { showBalloonFor(balloonVisibleFor); } });
        mo.observe(document.documentElement, { attributes: true, attributeFilter: ['lang'] });
      } catch(e) {}
      function updateCtaLabels(){
        var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
        var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
        var p = document.getElementById('heroCtaPrimary');
        var s = document.getElementById('heroCtaSecondary');
        if (p && typeof dict['#ctaPrimary'] === 'string') { p.textContent = dict['#ctaPrimary']; p.setAttribute('aria-label', dict['#ctaPrimary']); }
        if (s && typeof dict['#ctaSecondary'] === 'string') { s.textContent = dict['#ctaSecondary']; s.setAttribute('aria-label', dict['#ctaSecondary']); }
      }
      function updateAvatarAria(){
        var lang = (function(){ try { return localStorage.getItem('lang') || 'en'; } catch(e){ return 'en'; } })();
        var dict = (function(){ try { return (window.__i18n && window.__i18n[lang]) || {}; } catch(e) { return {}; } })();
        var f = document.getElementById('avatarFoxCard');
        var b = document.getElementById('avatarBearCard');
        var p = document.getElementById('avatarPenguinCard');
        if (f && typeof dict['#avatarFoxAria'] === 'string') f.setAttribute('aria-label', dict['#avatarFoxAria']);
        if (b && typeof dict['#avatarBearAria'] === 'string') b.setAttribute('aria-label', dict['#avatarBearAria']);
        if (p && typeof dict['#avatarPenguinAria'] === 'string') p.setAttribute('aria-label', dict['#avatarPenguinAria']);
      }
      // Initial labels
      updateCtaLabels();
      updateAvatarAria();
    })();
  </script>

  <!-- YouTube IFrame API -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <!-- Analytics & Event Tracking -->
  <script>
    (function initAnalytics(){
      // Add origin to YouTube iframe when served over http(s)
      var iframe = document.getElementById('hero-video');
      if (iframe && location.origin && /^https?:/i.test(location.origin) && iframe.src.indexOf('origin=') === -1) {
        var sep = iframe.src.indexOf('?') === -1 ? '?' : '&';
        iframe.src = iframe.src + sep + 'origin=' + encodeURIComponent(location.origin);
      }

      // Link click tracking for store buttons
      var storeLinks = document.querySelectorAll('.buttons a');
      storeLinks.forEach(function(a){
        a.addEventListener('click', function(){
          if (typeof gtag === 'function') {
            var label = (a.getAttribute('aria-label') || '').toLowerCase();
            var store = label.indexOf('app store') !== -1 ? 'apple' : (label.indexOf('google play') !== -1 ? 'google' : 'unknown');
            gtag('event', 'store_click', {
              store: store,
              link_url: a.href,
              transport_type: 'beacon'
            });
          }
        });
      });

      // Link click tracking for social buttons
      var socialLinks = document.querySelectorAll('.social-buttons a');
      socialLinks.forEach(function(a){
        a.addEventListener('click', function(){
          if (typeof gtag === 'function') {
            gtag('event', 'social_click', {
              network: a.getAttribute('aria-label') || 'unknown',
              link_url: a.href,
              transport_type: 'beacon'
            });
          }
        });
      });
      // Feature card clicks
      var featureCards = [
        { id: 'featureCard1', feature: 'memory' },
        { id: 'featureCard2', feature: 'selfcare' },
        { id: 'featureCard3', feature: 'growth' },
        { id: 'featureCard4', feature: 'customize' }
      ];
      featureCards.forEach(function(fc){
        var el = document.getElementById(fc.id);
        if (!el) return;
        el.addEventListener('click', function(){
          if (typeof gtag === 'function') {
            gtag('event', 'value_card_click', { feature: fc.feature, transport_type: 'beacon' });
          }
        });
        el.addEventListener('keydown', function(ev){
          if (ev.key === 'Enter' || ev.key === ' ') {
            ev.preventDefault();
            if (typeof gtag === 'function') {
              gtag('event', 'value_card_click', { feature: fc.feature, transport_type: 'beacon' });
            }
          }
        });
      });
      // FAQ analytics and smooth scroll
      try {
        document.querySelectorAll('.faq-item').forEach(function(d){
          d.addEventListener('toggle', function(){
            if (d.open && typeof gtag === 'function') {
              var q = d.querySelector('summary');
              var id = q ? q.id : 'unknown';
              gtag('event', 'faq_open', { question: id });
            }
          });
        });
      } catch(e) {}
      try {
        var cta = document.getElementById('privacyStripCtaLink');
        if (cta) cta.addEventListener('click', function(ev){ ev.preventDefault(); var target = document.getElementById('faq'); if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' }); });
      } catch(e) {}
      // Screenshots analytics & nav (invoked after showcase inject as well)
      function __wireShowcase(){
        var scroller = document.getElementById('shotsScroller');
        if (!scroller) return;
        var prevBtn = document.getElementById('shotsPrev');
        var nextBtn = document.getElementById('shotsNext');
        // Only apply mobile scroller behavior if overflow is possible
        var isDesktop = window.matchMedia && window.matchMedia('(min-width: 992px)').matches;
        if (isDesktop) {
          if (prevBtn) { try { prevBtn.setAttribute('hidden',''); prevBtn.setAttribute('aria-hidden','true'); } catch(e) {} }
          if (nextBtn) { try { nextBtn.setAttribute('hidden',''); nextBtn.setAttribute('aria-hidden','true'); } catch(e) {} }
        }
        var lastScrollFire = 0;
        scroller.addEventListener('scroll', function(){
          var now = Date.now();
          if (now - lastScrollFire > 1000) {
            lastScrollFire = now;
            if (typeof gtag === 'function') gtag('event', 'screenshot_swipe');
          }
        }, { passive: true });
        var imgs = scroller.querySelectorAll('.shot-img');
        for (var i = 0; i < imgs.length; i++){
          (function(idx){
            imgs[idx].addEventListener('click', function(){
              if (typeof gtag === 'function') gtag('event', 'screenshot_click', { index: idx + 1 });
            });
          })(i);
        }
        function updateArrowVisibility(){
          if (!prevBtn || !nextBtn) return;
          var atStart = scroller.scrollLeft <= 1;
          var atEnd = (scroller.scrollLeft + scroller.clientWidth) >= (scroller.scrollWidth - 1);
          if (atStart) { prevBtn.setAttribute('hidden',''); prevBtn.setAttribute('aria-hidden','true'); }
          else { prevBtn.removeAttribute('hidden'); prevBtn.setAttribute('aria-hidden','false'); }
          if (atEnd) { nextBtn.setAttribute('hidden',''); nextBtn.setAttribute('aria-hidden','true'); }
          else { nextBtn.removeAttribute('hidden'); nextBtn.setAttribute('aria-hidden','false'); }
        }
        function snapToNearest(){
          var w = scroller.getBoundingClientRect().width;
          var i = Math.round(scroller.scrollLeft / (w + 12));
          scroller.scrollTo({ left: i * (w + 12), behavior: 'smooth' });
          // Update arrow visibility after snapping
          setTimeout(updateArrowVisibility, 180);
        }
        var snapTimer;
        scroller.addEventListener('scroll', function(){
          clearTimeout(snapTimer);
          snapTimer = setTimeout(snapToNearest, 120);
          updateArrowVisibility();
        }, { passive: true });
        if (prevBtn && nextBtn){
          prevBtn.addEventListener('click', function(){ scroller.scrollBy({ left: -(scroller.clientWidth + 12), behavior: 'smooth' }); setTimeout(updateArrowVisibility, 50); });
          nextBtn.addEventListener('click', function(){ scroller.scrollBy({ left: (scroller.clientWidth + 12), behavior: 'smooth' }); setTimeout(updateArrowVisibility, 50); });
        }
        // Initialize arrow visibility state
        updateArrowVisibility();
      }
      try { window.__initShowcase = __wireShowcase; } catch(e) { window.__initShowcase = __wireShowcase; }
      // In case the showcase is already present before this script executes
      try { __wireShowcase(); } catch(e) {}
    })();

    // YouTube player tracking
    var ytPlayer;
    function onYouTubeIframeAPIReady(){
      var el = document.getElementById('hero-video');
      if (!el) return;
      ytPlayer = new YT.Player('hero-video', {
        events: {
          onStateChange: function(e){
            if (typeof gtag !== 'function') return;
            var baseParams = { video_title: 'Remember app overview', video_id: 'PlOfxdc0Ytc' };
            switch(e.data){
              case YT.PlayerState.PLAYING:
                gtag('event', 'video_play', Object.assign({} , baseParams));
                break;
              case YT.PlayerState.PAUSED:
                gtag('event', 'video_pause', Object.assign({} , baseParams));
                break;
              case YT.PlayerState.ENDED:
                gtag('event', 'video_complete', Object.assign({} , baseParams));
                break;
            }
          }
        }
      });
    }
  </script>
</body>
</html>
